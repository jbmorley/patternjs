<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>pattern.js</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/default.min.css">
    <link id="theme" rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
    <script>

function onDocumentReady(callback) {
            document.addEventListener('DOMContentLoaded', callback, false);
        }

        function onResize(element, callback) {
                var parent = element.parentElement;
                var resizeCallback = function() {
                    callback(element, parent.clientWidth, parent.clientHeight);
                }
                window.addEventListener('resize', resizeCallback, false);
                resizeCallback();
        }

        function makeResizingCanvas(id, height, callback) {
            onDocumentReady(function() {
                onResize(document.getElementById(id), function(canvas, parentWidth, parentHeight) {
                    canvas.width = parentWidth * window.devicePixelRatio;
                    canvas.height = height * window.devicePixelRatio;
                    canvas.style.width = parentWidth + 'px';
                    canvas.style.height = height + 'px';
                    callback(canvas);
                });
            });
        }

        function addDownload(canvas) {
            canvas.onclick = function() {
                window.open(canvas.toDataURL('image/png'));
            };
        }

    </script>
</head>
<body>

<h1>pattern.js</h1>

<h2>麻の葉, Asa no ha</h2>
<canvas class="pattern" id="asanoha" width="600" height="400"></canvas>
<script type="text/javascript">
    makeResizingCanvas('asanoha', 300, function(canvas) {
        Pattern.asanoha({
            canvas: canvas,
            style: Pattern.styles.darkBlue,
            lineDrawer: Pattern.drawers.line(2),
        });
    });
</script>
<pre><code class="javascript">Pattern.asanoha({
    canvas: canvas,
    style: Pattern.styles.darkBlue,
    lineDrawer: Pattern.drawers.line(2),
});</code></pre>

<canvas class="pattern" id="asanoha-dots" width="600" height="400"></canvas>
<script type="text/javascript">
    makeResizingCanvas('asanoha-dots', 300, function(canvas) {
        Pattern.asanoha({
            canvas: canvas,
            style: Pattern.styles.darkRed,
            lineDrawer: Pattern.drawers.dottedLine(2, 8),
        });
    });
</script>
<pre><code class="javascript">Pattern.asanoha({
    canvas: canvas,
    style: Pattern.styles.darkRed,
    lineDrawer: Pattern.drawers.dottedLine(2, 8),
});</code></pre>

<h2>七宝, Shippou</h2>
<canvas class="pattern" id="circles" width="600" height="400"></canvas>
<script type="text/javascript">
    makeResizingCanvas('circles', 300, function(canvas) {
        Pattern.shippou({
            canvas: canvas,
            style: Pattern.styles.purple,
        });
    });
</script>
<pre><code class="javascript">Pattern.shippou({
    canvas: canvas,
    style: Pattern.styles.purple,
});</code></pre>

<h2>青海波, Seigaiha</h2>

<canvas class="pattern" id="waves" width="600" height="400"></canvas>
<script type="text/javascript">
    makeResizingCanvas('waves', 300, function(canvas) {
        Pattern.seigaiha({
            canvas: canvas,
            style: Pattern.styles.monochrome,
            lineWidth: 3,
            radius: 55,
            gap: 10,
            count: 5,
            alternating: false,
        });
    });
</script>
<pre><code class="javascript">Pattern.seigaiha({
    canvas: canvas,
    style: Pattern.styles.monochrome,
    lineWidth: 3,
    radius: 55,
    gap: 10,
    count: 5,
    alternating: false,
});</code></pre>

<canvas class="pattern" id="waves-light" width="600" height="400"></canvas>
<script type="text/javascript">
    makeResizingCanvas('waves-light', 300, function(canvas) {
        Pattern.seigaiha({
            canvas: canvas, 
            style: Pattern.styles.sky,
            lineWidth: 2, 
            radius: 80,
            gap: 7, 
            count: 11,
            alternating: false,
        });
    });
</script>
<pre><code class="javascript">Pattern.seigaiha({
    canvas: canvas, 
    style: Pattern.styles.sky,
    lineWidth: 2, 
    radius: 80,
    gap: 7, 
    count: 11,
    alternating: false,
});</code></pre>

<canvas class="pattern" id="waves-inverted" width="600" height="400"></canvas>
<script type="text/javascript">
    makeResizingCanvas('waves-inverted', 300, function(canvas) {
        Pattern.seigaiha({
            canvas: canvas,
            style: Pattern.styles.blues,
            lineWidth: 3,
            radius: 44,
            gap: 8,
            count: 5,
            alternating: true
        });
    });
</script>
<pre><code class="javascript">Pattern.seigaiha({
    canvas: canvas,
    style: Pattern.styles.blues,
    lineWidth: 3,
    radius: 44,
    gap: 8,
    count: 5,
    alternating: true
});</code></pre>

<h2>Unknown 1</h2>

<canvas class="pattern" id="unknown" width="600" height="400"></canvas>
<script type="text/javascript">
    function unknown({canvas, style}={}) {
        
        var Turtle = function({context, x, y}={}) {
        
            this.context = context;
            this.x = x;
            this.y = y;
            this.angle = 0;
            
            this.lineTo = function(x, y) {
                this.context.moveTo(this.x, this.y);
                this.context.lineTo(x, y);
                this.context.stroke();
                this.x = x;
                this.y = y;
            };
            
            this.forward = function(distance) {
                var x = Math.sin(this.angle) * distance;
                var y = Math.cos(this.angle) * distance;
                this.lineTo(this.x + x, this.y + y);
            };
            
            this.turn = function({angle}={}) {
                this.angle = this.angle + angle;
            };
            
            this.left = function({angle}={}) {
                if (angle === undefined) {
                    angle = Math.PI / 2;
                }
                this.turn({angle: angle});
            };
            
            this.right = function({angle}={}) {
                if (angle === undefined) {
                    angle = Math.PI / 2;
                }
                this.turn({angle: angle * -1});
            };
            
        };
        
        var drawPattern = function(context, x, y, step, left) {
            var right = Math.PI - left;
            var turtle = new Turtle({context: context, x: x, y: y});
            turtle.right({angle: left});
            turtle.forward(step * 7);
            turtle.left({angle: right});
            turtle.forward(step);
            turtle.left({angle: left});
            turtle.forward(step);
            turtle.right({angle: left});
            turtle.forward(step);
            turtle.left({angle: left});
            turtle.forward(step);
            turtle.left({angle: right});
            turtle.forward(step);
            turtle.right({angle: right});
            turtle.forward(step);
            turtle.right({angle: left});
            turtle.forward(step * 7);
            turtle.right({angle: right});
            turtle.forward(step);
            turtle.right({angle: left});
            turtle.forward(step);
            turtle.left({angle: left});
            turtle.forward(step);
            turtle.left({angle: right});
            turtle.forward(step);
            turtle.right({angle: right});
            turtle.forward(step);
            turtle.left({angle: right});
            turtle.forward(step);
            turtle.left({angle: left});
            turtle.forward(step * 7);
            turtle.left({angle: right});
            turtle.forward(step);
            turtle.left({angle: left});
            turtle.forward(step);
            turtle.right({angle: left});
            turtle.forward(step);
            turtle.left({angle: left});
            turtle.forward(step);
            turtle.left({angle: right});
            turtle.forward(step);
            turtle.right({angle: right});
            turtle.forward(step);
            turtle.right({angle: left});
            turtle.forward(step * 7);
            turtle.right({angle: right});
            turtle.forward(step);
            turtle.right({angle: left});
            turtle.forward(step);
            turtle.left({angle: left});
            turtle.forward(step);
            turtle.left({angle: right});
            turtle.forward(step);
            turtle.right({angle: right});
            turtle.forward(step);
            turtle.left({angle: right});
            turtle.forward(step);
        }
        
        var alternate = function({x, y,
                                  width, height,
                                  stepX, stepY,
                                  offset, draw}={}) {
            if (offset === undefined) {
                offset = false;
            }
        
            for (var j = y - stepY; j < y + height; j = j + ( stepY * 2 )) {
                for (var i = x - stepX; i < x + width + stepX; i = i + stepX) {
                    draw({x: i, y: j});
                    var i2 = i;
                    if (offset) {
                        i2 = i + ( stepX / 2 );                    
                    }
                    draw({x: i2, y: j + stepY});
                }
            }
        };

        var context = canvas.getContext('2d');
        Pattern.applyStyle(context, style);
        context.fillRect(0, 0, canvas.width, canvas.height);
        var step = 10 * window.devicePixelRatio;
        context.lineWidth = 4;
        
        var stepX = 180;
        var stepY = 100;
        var angle = Math.PI / 3;
        
        // var height = ( sin(angle) * ( step * 7 ) ) + ( sin(angle) )
                
        alternate({x: 0, y: 0,
                   width: canvas.width, height: canvas.height,
                   stepX: stepX, stepY: stepY,
                   draw: function({x, y}={}) {
                       drawPattern(context, x, y, step, angle);
                   }});
    }

    makeResizingCanvas('unknown', 300, function(canvas) {
        unknown({
            canvas: canvas,
            style: Pattern.styles.monochrome,
        });
    });
</script>
<pre><code class="javascript">Pattern.triangles({
    canvas: canvas,
    style: Pattern.styles.monochrome,
});</code></pre>

<h2>Unknown 2</h2>

<canvas class="pattern" id="triangles" width="600" height="400"></canvas>
<script type="text/javascript">
    makeResizingCanvas('triangles', 300, function(canvas) {
        Pattern.triangles({
            canvas: canvas,
            style: Pattern.styles.monochrome,
        });
    });
</script>
<pre><code class="javascript">Pattern.triangles({
    canvas: canvas,
    style: Pattern.styles.monochrome,
});</code></pre>

<p class="copyright">
    Copyright &copy; Jason Barrie Morley 2019
</p>

<script src="pattern.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

</body>
</html>